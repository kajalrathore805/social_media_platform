
<%= render  "shared/post_nav"%>

<div class='posts-container d-flex flex-column mt-3 p-3 container-sm align-items-center' style="gap: 30px">
  <% @posts.each do |post|%>
    <div class="post-container d-flex flex-column p-3 border rounded shadow-sm w-100" style="gap: 15px; max-width: 600px;">
      <div class="user-detail d-flex align-items-center border rounded shadow-sm w-100" style="gap: 10px">  		
      	<div class="user-image">
          <%= image_tag post.user.image.variant(resize_to_limit: [200,200]), class: 'rounded-circle', width: '60', height: '60' %>   
        </div>
  			<div class="user-name fw-semibold">
          <%= post.user.name %>   
        </div>
        <div class="follow-btn" style="padding-left: 55%"> 
          <% if post.user.followers.exists?(id: @current_user.id)%>
            <%= link_to  user_follows_path(post.user.id), data: { turbo_method: :delete, turbo_confirm: "Unfollow?"}, class:"btn btn-sm btn-danger" do %>Unfollow
            <% end %>
          <% else %>
            <%= link_to  user_follows_path(post.user.id), data: { turbo_method: :post, turbo_confirm: "follow?"}, class:"btn btn-sm btn-secondary" do %>follow
            <% end %>
          <% end %>
        </div>
      </div>	
  		<div class="post-detail">
        <div class="post-title fs-4 fw-semibold">
          <%= link_to  post.title, post_path(post),class: 'text-decoration-none text-dark'%>
    		</div>
  			<div class="post-images d-flex" style="gap: 5px">
          <% post.images.each do |image| %>
    				<div class="post-image">
              <%= image_tag image.variant(resize_to_limit: [300,300]),size:"100x100" %>
            </div>
          <% end %>
  			</div>
      </div>
      <%= render "posts/like_button", post: post, current_user: @current_user %>
  	</div>
  <% end %>
</div>

<script>
$(document).ready(function(){
 
  $(".like-btn").click(function(e){
   e.preventDefault();
   var urls = $(this).attr('href')
    
    $.ajax({url: urls, type:"post", success: function(){
      alert('Liked successfully');
    }});
  });
});
</script>